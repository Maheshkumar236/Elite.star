<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Esports Pro</title>
    <!-- Tailwind CSS for Styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- React & Babel CDNs (Necessary to run JSX in browser) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        @keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .animate-in { animation: slideIn 0.5s ease-out forwards; }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut, RecaptchaVerifier, signInWithPhoneNumber } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, doc, setDoc, onSnapshot, collection, addDoc, updateDoc, deleteDoc, arrayUnion, getDoc, getDocs, query } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // Firebase Config (Aapki Real Keys)
        const firebaseConfig = {
  apiKey: "AIzaSyDPChNIAQz0gEmsuDFpACl0XvWm-DNcf2k",
  authDomain: "eliteweb-5b512.firebaseapp.com",
  projectId: "eliteweb-5b512",
  storageBucket: "eliteweb-5b512.firebasestorage.app",
  messagingSenderId: "474751993215",
  appId: "1:474751993215:web:88be5ffccdd88651cf464a",
  measurementId: "G-9HZY4280CY"
};
        };

        // Initialize
        const app = initializeApp(firebaseConfig);
        window.auth = getAuth(app);
        window.db = getFirestore(app);
        window.firebaseStore = { doc, setDoc, onSnapshot, collection, addDoc, updateDoc, deleteDoc, arrayUnion, getDoc, getDocs, query, RecaptchaVerifier, signInWithPhoneNumber, signOut, onAuthStateChanged };
    </script>

    <!-- React App Logic -->
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { Trophy, Gamepad2, Bell, Settings, ShieldCheck, UserCheck, Wallet, Zap, Award, Camera, Moon, Sun, ShieldAlert, LogOut, ChevronRight, Clock, Crown, Medal, Trash2, CheckCircle, XCircle, Sparkles, Bot, MessageSquare, Send, Gift, Copy, Phone, TrendingUp, Star } = lucide;

        function App() {
            const { doc, setDoc, onSnapshot, collection, addDoc, updateDoc, deleteDoc, arrayUnion, getDoc, getDocs, query, RecaptchaVerifier, signInWithPhoneNumber, signOut, onAuthStateChanged } = window.firebaseStore;
            const auth = window.auth;
            const db = window.db;
            const appId = "elite_pro_final_v3";

            const [user, setUser] = useState(null);
            const [userData, setUserData] = useState(null);
            const [loading, setLoading] = useState(true);
            const [activeTab, setActiveTab] = useState('home');
            const [isDarkMode, setIsDarkMode] = useState(true);
            const [toast, setToast] = useState(null);

            // OTP States
            const [phone, setPhone] = useState("");
            const [otp, setOtp] = useState("");
            const [otpSent, setOtpSent] = useState(false);
            const [confirmationResult, setConfirmationResult] = useState(null);
            const [loginLoading, setLoginLoading] = useState(false);

            // Tournament Data
            const [matches, setMatches] = useState([]);
            const [winners, setWinners] = useState([]);
            const [chatMessages, setChatMessages] = useState([]);
            const [globalAlert, setGlobalAlert] = useState(null);

            // Admin States
            const [isAdminUnlocked, setIsAdminUnlocked] = useState(false);
            const [showAdminModal, setShowAdminModal] = useState(false);
            const [showJoinModal, setShowJoinModal] = useState(false);
            const [selectedMatch, setSelectedMatch] = useState(null);
            const [adminTapCount, setAdminTapCount] = useState(0);
            const [staffSubTab, setStaffSubTab] = useState('matches');
            const chatEndRef = useRef(null);

            const showMessage = (msg, type = 'success') => {
                setToast({ msg, type });
                setTimeout(() => setToast(null), 3000);
            };

            const setupRecaptcha = () => {
                if (!window.recaptchaVerifier) {
                    window.recaptchaVerifier = new RecaptchaVerifier(auth, 'recaptcha-container', { 'size': 'invisible' });
                }
            };

            const handleSendOtp = async (e) => {
                e.preventDefault();
                if (phone.length < 10) return showMessage("Pura number daalo!", "error");
                setLoginLoading(true);
                setupRecaptcha();
                try {
                    const confirmation = await signInWithPhoneNumber(auth, `+91${phone}`, window.recaptchaVerifier);
                    setConfirmationResult(confirmation);
                    setOtpSent(true);
                    showMessage("OTP SMS Bhej Diya!");
                } catch (err) { showMessage("OTP Nahi Gaya. Firebase Check Karein!", "error"); }
                setLoginLoading(false);
            };

            const handleVerifyOtp = async (e) => {
                e.preventDefault();
                setLoginLoading(true);
                try {
                    const result = await confirmationResult.confirm(otp);
                    const newUser = result.user;
                    const profileRef = doc(db, 'artifacts', appId, 'users', newUser.uid, 'profile', 'data');
                    const snap = await getDoc(profileRef);
                    if (!snap.exists()) {
                        await setDoc(profileRef, {
                            username: `Gamer_${newUser.uid.slice(0,5)}`,
                            balance: 50,
                            uid: newUser.uid,
                            phone: newUser.phoneNumber,
                            totalWins: 0,
                            joinedMatches: [],
                            referralCode: newUser.uid.slice(0, 6).toUpperCase(),
                            xp: 10
                        });
                    }
                    showMessage("Welcome Survivor!");
                } catch (err) { showMessage("OTP Galat Hai!", "error"); }
                setLoginLoading(false);
            };

            useEffect(() => {
                const unsub = onAuthStateChanged(auth, (u) => { setUser(u); setLoading(false); });
                return () => unsub();
            }, []);

            useEffect(() => {
                if (!user) return;
                const unsubM = onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'matches'), (snap) => setMatches(snap.docs.map(d => ({ id: d.id, ...d.data() }))));
                const unsubU = onSnapshot(doc(db, 'artifacts', appId, 'users', user.uid, 'profile', 'data'), (ds) => { if (ds.exists()) setUserData(ds.data()); });
                const unsubW = onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'winners'), (snap) => setWinners(snap.docs.map(d => ({ id: d.id, ...d.data() }))));
                const unsubC = onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'chat'), (snap) => setChatMessages(snap.docs.map(d => ({ id: d.id, ...d.data() })).sort((a,b) => a.timestamp - b.timestamp).slice(-30)));
                const unsubA = onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', 'alerts'), (snap) => {
                    const latest = snap.docs.map(d => ({id: d.id, ...d.data()})).sort((a,b) => b.timestamp - a.timestamp)[0];
                    if (latest && latest.timestamp > Date.now() - 300000) setGlobalAlert(latest);
                });
                return () => { unsubM(); unsubU(); unsubW(); unsubC(); unsubA(); };
            }, [user]);

            const playerLevel = Math.floor(((userData?.xp || 0) / 20)) + 1;

            if (loading) return <div className="h-screen bg-[#05050a] flex items-center justify-center text-orange-600 font-black italic animate-pulse tracking-widest text-2xl">ELITE ARENA...</div>;

            if (!user) return (
                <div className="min-h-screen bg-[#05050a] flex flex-col items-center justify-center p-8 text-white text-center font-sans">
                    <div id="recaptcha-container"></div>
                    <div className="w-24 h-24 bg-orange-600 rounded-[2.5rem] flex items-center justify-center shadow-[0_0_50px_rgba(234,88,12,0.3)] mb-10 rotate-12">
                        <Gamepad2 size={48} color="white" />
                    </div>
                    <h1 className="text-5xl font-black italic uppercase tracking-tighter mb-4">ELITE LOGIN</h1>
                    <p className="text-gray-500 text-xs font-bold uppercase tracking-[0.3em] mb-12">Mobile Verification Required</p>
                    
                    {!otpSent ? (
                        <form onSubmit={handleSendOtp} className="w-full max-w-sm space-y-6">
                            <div className="relative">
                                <span className="absolute left-6 top-1/2 -translate-y-1/2 text-gray-500 font-bold text-lg">+91</span>
                                <input value={phone} onChange={(e) => setPhone(e.target.value.replace(/\D/g,''))} type="tel" placeholder="Mobile Number" maxLength={10} required className="w-full bg-white/5 border border-white/10 rounded-3xl p-6 pl-16 outline-none font-bold text-xl italic focus:border-orange-500 transition-all" />
                            </div>
                            <button disabled={loginLoading} type="submit" className="w-full bg-orange-600 py-6 rounded-3xl font-black uppercase text-sm shadow-2xl tracking-widest active:scale-95 disabled:opacity-50">{loginLoading ? 'SENDING...' : 'GET OTP'}</button>
                        </form>
                    ) : (
                        <form onSubmit={handleVerifyOtp} className="w-full max-w-sm space-y-6">
                            <input value={otp} onChange={(e) => setOtp(e.target.value.replace(/\D/g,''))} type="text" placeholder="6-Digit OTP" maxLength={6} required className="w-full bg-white/5 border border-white/10 rounded-3xl p-6 outline-none font-bold text-center text-4xl tracking-[0.8em] focus:border-orange-500 transition-all" />
                            <button disabled={loginLoading} type="submit" className="w-full bg-orange-600 py-6 rounded-3xl font-black uppercase text-sm shadow-2xl tracking-widest active:scale-95 disabled:opacity-50">VERIFY CODE</button>
                            <button type="button" onClick={() => setOtpSent(false)} className="text-xs text-gray-500 font-bold uppercase underline">Change Number</button>
                        </form>
                    )}
                </div>
            );

            return (
                <div className={`min-h-screen ${isDarkMode ? 'bg-[#05050a] text-white' : 'bg-white text-black'} font-sans pb-32 transition-colors duration-500`}>
                    {toast && <div className="fixed top-10 left-1/2 -translate-x-1/2 z-[200] px-8 py-5 rounded-3xl shadow-2xl bg-orange-600 text-white font-black italic text-sm border border-orange-400 animate-in">{toast.msg}</div>}

                    <header className="fixed top-0 inset-x-0 h-20 bg-black/40 backdrop-blur-3xl border-b border-white/5 flex items-center justify-between px-8 z-50">
                        <div className="flex items-center gap-3">
                            <Zap className="text-orange-600 fill-orange-600" size={24} />
                            <h1 className="font-black italic text-2xl uppercase tracking-tighter">ELITE PRO</h1>
                        </div>
                        <div className="px-5 py-2.5 rounded-2xl bg-white/5 border border-white/10 flex items-center gap-3 text-sm font-black shadow-inner">
                            <Wallet className="text-green-500" size={18} /> ₹{userData?.balance || 0}
                        </div>
                    </header>

                    <main className="pt-28 px-6 max-w-lg mx-auto">
                        {activeTab === 'home' && (
                            <div className="animate-in space-y-8">
                                <div className="bg-gradient-to-br from-orange-600 to-red-600 p-10 rounded-[3rem] shadow-2xl relative overflow-hidden group">
                                    <div className="relative z-10">
                                        <h2 className="text-4xl font-black italic uppercase tracking-tighter leading-none">Pro Scrims</h2>
                                        <p className="text-xs font-bold opacity-80 uppercase tracking-widest mt-2 italic">Earn While You Play</p>
                                        <button className="mt-8 bg-white text-black px-8 py-3 rounded-2xl text-xs font-black uppercase shadow-xl hover:scale-105 transition-transform">Match Rules</button>
                                    </div>
                                    <Gamepad2 className="absolute -bottom-6 -right-6 w-48 h-48 opacity-20 rotate-12 transition-transform group-hover:scale-110" />
                                </div>

                                <div className="space-y-5">
                                    <h4 className="font-black text-xs uppercase italic text-gray-500 tracking-[0.3em] ml-2 flex items-center gap-3"><Clock className="text-orange-500" size={18} /> LIVE ARENA</h4>
                                    {matches.map(m => (
                                        <div key={m.id} className="bg-white/5 border border-white/10 p-8 rounded-[2.5rem] border-l-8 border-l-orange-600 shadow-2xl backdrop-blur-md">
                                            <div className="flex justify-between items-start mb-2">
                                                <span className="text-xs font-black uppercase text-orange-500 bg-orange-600/10 px-4 py-1 rounded-full">{m.map}</span>
                                                <span className="text-xs text-gray-500 italic font-bold">{m.time}</span>
                                            </div>
                                            <h5 className="text-2xl font-black italic uppercase tracking-tight">{m.title}</h5>
                                            <div className="mt-6 flex justify-between items-center">
                                                <div className="flex gap-6">
                                                    <div><p className="text-[10px] text-gray-500 font-black">POOL</p><p className="text-lg font-black text-green-500 italic">₹{m.prizePool}</p></div>
                                                    <div><p className="text-[10px] text-gray-500 font-black">SLOTS</p><p className="text-lg font-black text-gray-400 italic">{m.joinedCount}/{m.totalSlots || 48}</p></div>
                                                </div>
                                                <button onClick={() => { setSelectedMatch(m); setShowJoinModal(true); }} className="px-10 py-4 rounded-2xl text-xs font-black uppercase bg-orange-600 text-white shadow-2xl active:scale-95 transition-all">JOIN NOW</button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {activeTab === 'settings' && (
                            <div className="space-y-8 pb-12 animate-in">
                                <h2 className="text-3xl font-black italic uppercase flex items-center gap-4">
                                    <Settings onClick={() => setAdminTapCount(p => p+1 >= 10 ? (setShowAdminModal(true),0) : p+1)} className="text-orange-500 cursor-pointer" size={32} /> PLAYER HUB
                                </h2>

                                <div className="bg-white/5 p-10 rounded-[4rem] border border-white/10 text-center space-y-8 shadow-2xl backdrop-blur-md relative overflow-hidden">
                                    <div className="absolute top-0 right-0 p-8 opacity-5"><Star size={100} /></div>
                                    <div className="relative inline-block">
                                        <img src={userData?.photoURL || "https://images.unsplash.com/photo-1542751371-adc38448a05e?auto=format&fit=crop&q=80&w=200"} className="w-40 h-40 rounded-[3rem] object-cover border-4 border-orange-600/30 shadow-2xl mx-auto" />
                                        <div className="absolute -bottom-4 -right-4 bg-orange-600 px-6 py-2.5 rounded-full text-sm font-black italic shadow-2xl flex items-center gap-2"><Star size={16}/> LVL {playerLevel}</div>
                                    </div>
                                    <div>
                                        <h4 className="font-black text-4xl italic uppercase text-orange-500 tracking-tighter">@{userData?.username || 'ELITE_GAMER'}</h4>
                                        <p className="text-xs text-gray-500 font-bold mt-2 uppercase tracking-[0.4em]">{userData?.phone}</p>
                                    </div>

                                    <div className="bg-white/5 border border-white/10 rounded-[2.5rem] p-8 space-y-6 shadow-xl">
                                        <div className="flex justify-between items-center">
                                            <h5 className="font-black text-xs uppercase text-gray-400 flex items-center gap-3"><Gift className="text-blue-500" size={20}/> REFERRAL ID</h5>
                                            <span className="text-lg font-black text-white italic">{userData?.referralCode}</span>
                                        </div>
                                        <button onClick={() => { navigator.clipboard.writeText(userData?.referralCode); showMessage("Code Copied!"); }} className="w-full bg-blue-600 py-4 rounded-2xl font-black text-xs uppercase italic text-white shadow-lg active:scale-95">COPY & SHARE CODE</button>
                                    </div>

                                    <div className="grid grid-cols-2 gap-6">
                                        <div className="bg-black/40 p-8 rounded-[2.5rem] border border-white/5 border-l-4 border-l-green-500 shadow-inner">
                                            <Medal className="text-green-500 mx-auto mb-2" size={32} />
                                            <p className="text-[10px] font-black text-gray-500 uppercase">Total Wins</p>
                                            <p className="text-4xl font-black italic text-green-500">{userData?.totalWins || 0}</p>
                                        </div>
                                        <div className="bg-black/40 p-8 rounded-[2.5rem] border border-white/5 border-l-4 border-l-orange-500 shadow-inner">
                                            <Wallet className="text-orange-500 mx-auto mb-2" size={32} />
                                            <p className="text-[10px] font-black text-gray-500 uppercase">Paisa</p>
                                            <p className="text-4xl font-black italic text-orange-500">₹{userData?.balance || 0}</p>
                                        </div>
                                    </div>
                                </div>

                                <button onClick={() => signOut(auth)} className="w-full bg-red-600/10 border border-red-600/20 text-red-500 py-8 rounded-[3rem] font-black uppercase text-sm italic flex items-center justify-center gap-4 active:scale-95 shadow-xl transition-all"><LogOut size={24} /> TERMINATE SESSION</button>
                            </div>
                        )}
                    </main>

                    <nav className="fixed bottom-8 inset-x-8 h-24 bg-black/60 backdrop-blur-3xl border border-white/10 rounded-[3rem] flex items-center justify-around px-4 z-50 shadow-[0_20px_50px_rgba(0,0,0,0.5)]">
                        <NavBtn active={activeTab === 'home'} icon={<Trophy size={28}/>} label="Home" onClick={() => setActiveTab('home')} />
                        <NavBtn active={activeTab === 'rank'} icon={<TrendingUp size={28}/>} label="Rank" onClick={() => setActiveTab('rank')} />
                        <NavBtn active={activeTab === 'lobby'} icon={<MessageSquare size={28}/>} label="Lobby" onClick={() => setActiveTab('lobby')} />
                        <NavBtn active={activeTab === 'match'} icon={<Gamepad2 size={28}/>} label="Match" onClick={() => setActiveTab('match')} />
                        <NavBtn active={activeTab === 'settings'} icon={<Settings size={28}/>} label="Hub" onClick={() => setActiveTab('settings')} />
                    </nav>

                    {showJoinModal && (
                        <div className="fixed inset-0 bg-black/98 backdrop-blur-3xl flex items-center justify-center p-8 z-[100] animate-in">
                            <div className="bg-[#0c0c0c] border border-orange-600/20 p-12 rounded-[4rem] w-full max-w-md space-y-8 shadow-[0_0_100px_rgba(234,88,12,0.15)] text-center">
                                <h3 className="text-3xl font-black italic uppercase text-orange-500 tracking-tighter italic">Confirm Entry</h3>
                                <p className="text-xs text-gray-500 font-black uppercase tracking-widest">{selectedMatch?.title}</p>
                                <form onSubmit={async (e) => {
                                    e.preventDefault();
                                    const fd = new FormData(e.currentTarget);
                                    if (userData.balance < selectedMatch.entryFee) return showMessage("Paisa kam hai!", "error");
                                    await updateDoc(doc(db, 'artifacts', appId, 'public', 'data', 'matches', selectedMatch.id), {
                                        joinedCount: (selectedMatch.joinedCount || 0) + 1,
                                        participants: arrayUnion({ uid: user.uid, gameName: fd.get('gameName'), gameUID: fd.get('gameUID') })
                                    });
                                    await updateDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'profile', 'data'), {
                                        balance: Number(userData.balance) - Number(selectedMatch.entryFee),
                                        joinedMatches: arrayUnion(selectedMatch.id)
                                    });
                                    showMessage("Tournament Joined!");
                                    setShowJoinModal(false);
                                }} className="space-y-6">
                                    <input name="gameName" placeholder="In-Game Name (IGN)" required className="w-full bg-white/5 border border-white/10 rounded-3xl p-6 text-white italic text-sm outline-none font-bold" />
                                    <input name="gameUID" placeholder="Numerical UID" required className="w-full bg-white/5 border border-white/10 rounded-3xl p-6 text-white italic text-sm outline-none font-bold" />
                                    <button type="submit" className="w-full bg-orange-600 py-6 rounded-3xl font-black text-white text-sm uppercase shadow-2xl shadow-orange-600/30 active:scale-95">CONFIRM ENTRY</button>
                                    <button type="button" onClick={() => setShowJoinModal(false)} className="w-full text-gray-500 font-black text-xs uppercase italic tracking-widest">CANCEL</button>
                                </form>
                            </div>
                        </div>
                    )}

                    {showAdminModal && (
                        <div className="fixed inset-0 bg-black/98 backdrop-blur-3xl flex items-center justify-center p-8 z-[100] animate-in">
                            <div className="bg-[#0c0c0c] border border-orange-600/20 p-16 rounded-[5rem] w-full max-w-sm space-y-10 shadow-2xl">
                                <ShieldCheck className="w-24 h-24 text-orange-600 mx-auto" />
                                <h3 className="text-4xl font-black italic uppercase text-center text-white">ADMIN VAULT</h3>
                                <form onSubmit={(e) => {
                                    e.preventDefault();
                                    if (new FormData(e.currentTarget).get('pass') === "12") {
                                        setIsAdminUnlocked(true); setShowAdminModal(false); setActiveTab('admin');
                                    } else { showMessage("Access Denied", "error"); }
                                }} className="space-y-8">
                                    <input name="pass" type="password" placeholder="••••" required className="w-full bg-white/5 border border-white/10 rounded-[2.5rem] p-8 text-center text-5xl text-white outline-none font-mono" />
                                    <button type="submit" className="w-full bg-orange-600 py-6 rounded-3xl font-black text-white text-sm uppercase shadow-2xl">UNLOCK</button>
                                </form>
                                <button onClick={() => setShowAdminModal(false)} className="w-full text-gray-500 font-bold text-xs uppercase">BACK</button>
                            </div>
                        </div>
                    )}

                    {globalAlert && (
                        <div className="fixed inset-0 bg-black/90 backdrop-blur-3xl flex items-center justify-center p-8 z-[200] animate-in">
                            <div className="bg-red-600/10 border border-red-500/50 p-12 rounded-[4rem] w-full max-w-sm space-y-8 text-center relative overflow-hidden">
                                <ShieldAlert className="w-24 h-24 text-red-500 mx-auto animate-bounce" />
                                <h3 className="text-4xl font-black italic text-red-500 uppercase tracking-tighter">{globalAlert.title}</h3>
                                <p className="text-lg font-bold text-white italic">{globalAlert.message}</p>
                                <button onClick={() => setGlobalAlert(null)} className="w-full bg-red-600 py-6 rounded-3xl text-white font-black text-xs uppercase shadow-[0_0_50px_rgba(220,38,38,0.4)]">ACKNOWLEDGE</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const NavBtn = ({ active, icon, label, onClick }) => (
            <button onClick={onClick} className={`flex flex-col items-center gap-2 transition-all duration-300 ${active ? 'text-orange-500 -translate-y-2 scale-110' : 'text-gray-500'}`}>
                {React.cloneElement(icon, { strokeWidth: 3 })}
                <span className="text-[9px] font-black uppercase italic tracking-wider">{label}</span>
            </button>
        );

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>

